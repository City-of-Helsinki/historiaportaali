((e,a,t)=>{a.behaviors.mapControls={attach:function(a,t){let r=this;e(document).on("leaflet.map",(function(e,a,t,s){r.bindEraControls(t)}))},bindEraControls:function(a){let t=this,r=e(".map-controls__map-era .map-controls__map-era-item");r.on("click",(function(s){let l=e(s.target).data("map-era");mapApi=e(s.target).data("map-api"),mapWMSTitle=e(s.target).data("map-wms-title"),t.loadEraLayer(a,l,mapApi,mapWMSTitle),r.removeClass("active"),e(s.target).addClass("active")}))},loadEraLayer:function(e,a,t,r){let s=this,l=s.getMapApiUrl(t);if(r&&"present"!==a){let a=L.tileLayer.wms(l,{layers:r,format:"image/png",transparent:!0});a.addTo(e),a.on("load",(function(t){s.removeOtherMapLayers(e,a)}))}"present"==a&&s.removeOtherMapLayers(e,null)},removeOtherMapLayers:function(e,a){let t,r=Object.entries(e._layers).filter((([e,a])=>a.wmsParams?.layers));t=a?r.filter((([e,t])=>t.wmsParams.layers!==a.wmsParams.layers)):r,t.length&&t.forEach((e=>e[1].remove()))},getMapApiUrl:function(e){switch(e){case"kartta_hel_fi":return"https://kartta.hel.fi/ws/geoserver/avoindata/wms";case"geoserver_hel_fi":return"https://geoserver.hel.fi/geoserver/ows";default:return""}}}})(jQuery,Drupal,drupalSettings);