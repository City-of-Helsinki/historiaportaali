{% macro layer_option(layer, era) %}
  <option class="map-controls__map-layer-item main-map" data-map-layer-title="{{ layer.layer_title }}" data-map-api-endpoints="{{ layer.map_api_endpoints }}" data-map-api="{{ era.map_api }}" data-map-wms-title="{{ era.map_wms_title }}">
    {{ layer.layer_title }}
  </option>
{% endmacro %}

{% macro layer_select_block(select_id, label_text, placeholder_text, clear_label_text, layers, map_type, era) %}
  <div class="hds-text-input map-controls__mid-container {{ map_type == 'mobile' ? 'mobile' : '' }}">
    <label for="{{ select_id }}" class="visually-hidden">{{ label_text }}</label>
    <div class="map-controls__select-row">
      <select
        id="{{ select_id }}"
        class="map-controls__map-layer main-map"
        aria-label="{{ label_text }}"
        data-placeholder="{{ placeholder_text }}"
      >
        {% for layer in layers %}
          {{ _self.layer_option(layer, era) }}
        {% endfor %}
      </select>
      <button
        type="button"
        class="map-controls__clear-btn main-map"
        data-clear-for="{{ select_id }}"
        aria-label="{{ clear_label_text }}"
        title="{{ clear_label_text }}"
        hidden
      >
        {% include '@hdbt/misc/icon.twig' with { icon: 'cross', label: clear_label_text } %}
      </button>
    </div>
  </div>
{% endmacro %}

<div class="map-controls__top-container main-map">
  {{ _self.layer_select_block(
    'map-layer-select',
    'Map layer selector'|t({}, {'context': 'Map controls'}),
    'Maps'|t({}, {'context': 'Map controls'}),
    'Clear map layer selection'|t({}, {'context': 'Map controls'}),
    map_layers,
    'main-map',
    era
  ) }}
  {{ _self.layer_select_block(
    'photo-layer-select',
    'Photo layer selector'|t({}, {'context': 'Map controls'}),
    'Aerial photos'|t({}, {'context': 'Map controls'}),
    'Clear photo layer selection'|t({}, {'context': 'Map controls'}),
    photo_layers,
    'main-map',
    era
  ) }}
  <div class="hds-text-input map-controls__mid-container mobile">
    <label for="mobile-layer-select" class="visually-hidden">{{ 'Map layer selector'|t({}, {'context': 'Map controls'}) }}</label>
    <div class="map-controls__select-row">
      <select
        id="mobile-layer-select"
        class="map-controls__map-layer main-map"
        aria-label="{{ 'Map layer selector'|t({}, {'context': 'Map controls'}) }}"
        data-placeholder="{{ 'Map layers'|t({}, {'context': 'Map controls'}) }}"
      >
        <option disabled>{{ 'Maps'|t({}, {'context': 'Map controls'}) }}</option>
        {% for layer in map_layers %}
          {{ _self.layer_option(layer, era) }}
        {% endfor %}
        <option disabled>{{ 'Aerial photos'|t({}, {'context': 'Map controls'}) }}</option>
        {% for layer in photo_layers %}
          {{ _self.layer_option(layer, era) }}
        {% endfor %}
      </select>
      <button
        type="button"
        class="map-controls__clear-btn main-map"
        data-clear-for="mobile-layer-select"
        aria-label="{{ 'Clear map layer selection'|t({}, {'context': 'Map controls'}) }}"
        title="{{ 'Clear map layer selection'|t({}, {'context': 'Map controls'}) }}"
        hidden
      >
        {% include '@hdbt/misc/icon.twig' with { icon: 'cross', label: 'Clear map layer selection'|t({}, {'context': 'Map controls'}) } %}
      </button>
    </div>
  </div>
</div>

<div class="map-controls__sidebar-container">
  <div class="map-controls__control">
    <button class="map-controls__control-button" id="map-comparison-btn" type="button" aria-label="{{ 'Compare maps'|t({}, {'context': 'Map controls'}) }}" aria-pressed="false">
      {% include '@hdbt/misc/icon.twig' with {icon: 'map'} %}
      {{ 'Compare maps'|t({}, {'context': 'Map controls'}) }}
    </button>
  </div>

  <div class="map-controls__control">
    <button class="map-controls__control-button" id="zoom-in-btn" aria-label="{{ 'Zoom in'|t({}, {'context': 'Map controls'}) }}">
      {% include '@hdbt/misc/icon.twig' with {icon: 'zoom-in', label: 'Zoom in'|t({}, {'context': 'Map controls'}) } %}
    </button>
  </div>

  <div class="map-controls__control">
    <button class="map-controls__control-button" id="zoom-out-btn" aria-label="{{ 'Zoom out'|t({}, {'context': 'Map controls'}) }}">
      {% include '@hdbt/misc/icon.twig' with {icon: 'zoom-out', label: 'Zoom out'|t({}, {'context': 'Map controls'}) } %}
    </button>
  </div>

  <div class="map-controls__control">
    <button class="map-controls__control-button" id="locate-btn" aria-label="{{ 'Locate me'|t({}, {'context': 'Map controls'}) }}">
      {% include '@hdbt/misc/icon.twig' with {icon: 'locate', label: 'Locate me'|t({}, {'context': 'Map controls'}) } %}
    </button>
  </div>
</div>
