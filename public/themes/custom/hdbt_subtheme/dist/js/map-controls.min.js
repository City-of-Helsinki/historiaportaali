((e,a,t)=>{a.behaviors.mapControls={attach:function(a,t){let r=this;e(document).on("leaflet.map",(function(e,a,t,n){r.bindEraControls(t)}))},bindEraControls:function(a){let t=this,r=e(".map-controls__map-era .map-controls__map-era-item");r.on("click",(function(n){let i=e(n.target).data("map-era");mapApi=e(n.target).data("map-api"),mapWMSTitle=e(n.target).data("map-wms-title"),t.loadEraLayer(a,i,mapApi,mapWMSTitle),r.removeClass("active"),e(n.target).addClass("active")}))},loadEraLayer:function(e,a,t,r){let n=this,i=n.getMapApiUrl(t);if(r&&"present"!==a){n.showLoadingSpinner();let a=L.tileLayer.wms(i,{layers:r,format:"image/png",transparent:!0});a.addTo(e),a.on("load",(function(t){n.removeOtherMapLayers(e,a),n.hideLoadingSpinner()}))}"present"==a&&n.removeOtherMapLayers(e,null)},removeOtherMapLayers:function(e,a){let t,r=Object.entries(e._layers).filter((([e,a])=>a.wmsParams?.layers));t=a?r.filter((([e,t])=>t.wmsParams.layers!==a.wmsParams.layers)):r,t.length&&t.forEach((e=>e[1].remove()))},getMapApiUrl:function(e){switch(e){case"kartta_hel_fi":return"https://kartta.hel.fi/ws/geoserver/avoindata/wms";case"geoserver_hel_fi":return"https://geoserver.hel.fi/geoserver/ows";default:return""}},showLoadingSpinner:function(){e("#map-loading-overlay").fadeIn(150)},hideLoadingSpinner:function(){e("#map-loading-overlay").fadeOut(150)}}})(jQuery,Drupal,drupalSettings);