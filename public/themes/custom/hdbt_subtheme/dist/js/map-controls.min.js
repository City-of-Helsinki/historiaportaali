((o,t,e)=>{t.behaviors.mapControls={attach:function(t,e){let n=this;o(document).on("leaflet.map",(function(o,t,e,a){n.bindEraControls(e),n.bindZoomControls(e),n.bindLocateControl(e)}))},bindEraControls:function(t){let e=this,n=o(".map-controls__map-era .map-controls__map-era-item");n.on("click",(function(a){let r=o(a.target).data("map-era");mapApi=o(a.target).data("map-api"),mapWMSTitle=o(a.target).data("map-wms-title"),e.loadEraLayer(t,r,mapApi,mapWMSTitle),n.removeClass("active"),o(a.target).addClass("active")}))},loadEraLayer:function(o,t,e,n){let a=this,r=a.getMapApiUrl(e);if(n&&"present"!==t){a.showLoadingSpinner();let t=L.tileLayer.wms(r,{layers:n,format:"image/png",transparent:!0});t.addTo(o),t.on("load",(function(e){a.removeOtherMapLayers(o,t),a.hideLoadingSpinner()}))}"present"==t&&a.removeOtherMapLayers(o,null)},removeOtherMapLayers:function(o,t){let e,n=Object.entries(o._layers).filter((([o,t])=>t.wmsParams?.layers));e=t?n.filter((([o,e])=>e.wmsParams.layers!==t.wmsParams.layers)):n,e.length&&e.forEach((o=>o[1].remove()))},getMapApiUrl:function(o){switch(o){case"kartta_hel_fi":return"https://kartta.hel.fi/ws/geoserver/avoindata/wms";case"geoserver_hel_fi":return"https://geoserver.hel.fi/geoserver/ows";default:return""}},showLoadingSpinner:function(){o("#map-loading-overlay").fadeIn(150)},hideLoadingSpinner:function(){o("#map-loading-overlay").fadeOut(150)},bindZoomControls:function(t){let e=o(".map-controls__control-button#zoom-in-btn"),n=o(".map-controls__control-button#zoom-out-btn");e.on("click",(function(){t.zoomIn()})),n.on("click",(function(){t.zoomOut()}))},bindLocateControl:function(t){let e=this;o(".map-controls__control-button#locate-btn").on("click",(function(){navigator.geolocation?(e.showLoadingSpinner(),navigator.geolocation.getCurrentPosition((o=>{e.hideLoadingSpinner();const n=o.coords.latitude,a=o.coords.longitude;t.panTo([n,a]),t.setZoom(15)}),(o=>{console.log("Err: "+o),e.hideLoadingSpinner()}))):console.log("Geolocation is not supported by your browser")}))}}})(jQuery,Drupal,drupalSettings);