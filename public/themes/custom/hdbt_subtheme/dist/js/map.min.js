(()=>{var e=Object.defineProperty;var t=(t,n)=>e(t,"name",{value:n,configurable:true});((e,Drupal,drupalSettings,n)=>{let o;let i;Drupal.behaviors.map={attach:t(function(t,r){let a=this;if(n("map","body").length){e(document).on("leafletMapInit",function(t,n,r,l){if(l.startsWith("leaflet-map-view-combined-map-block")){o=r;i=e("#"+l);const t=a.getUrlParameter("id");a.bindPopupPositioning();if(t){setTimeout(function(){a.openPopupByNid(t)},300)}}})}a.bindFilterToggle(t)},"attach"),bindFilterToggle:t(function(t){$filterToggleBtn=e(n("button",".exposed-filters .toggle-filters-btn"));$filterContainer=e(".exposed-filters .exposed-filters__container");$filterToggleBtn.on("click",function(){$filterContainer.slideToggle(150);if($filterContainer.is(":visible")&&$filterToggleBtn.find("span.hds-icon").hasClass("hds-icon--angle-down")){$filterToggleBtn.find("span.hds-icon").removeClass("hds-icon--angle-down");$filterToggleBtn.find("span.hds-icon").addClass("hds-icon--angle-up")}else{$filterToggleBtn.find("span.hds-icon").removeClass("hds-icon--angle-up");$filterToggleBtn.find("span.hds-icon").addClass("hds-icon--angle-down")}})},"bindFilterToggle"),openPopupByNid:t(function(e){if(!o||!i||!e){return}const t=i.data("leaflet");if(!t?.markers){return}const n=String(e);let r=t.markers[n];if(!r){const e=Object.keys(t.markers).find(e=>e.startsWith(n+"-"));if(e){r=t.markers[e]}}if(!r){console.warn("Map: No marker found ID",n);console.log("Available marker IDs:",Object.keys(t.markers).map(e=>e.replace("-0","")));return}let a=false;o.eachLayer(e=>{if(e._group&&typeof e.getAllChildMarkers==="function"){if(e.getAllChildMarkers().includes(r)){a=true}}});this.zoomToLayer(r,a)},"openPopupByNid"),zoomToLayer:t(function(e,n=false){if(!e||!o){return false}if(n&&e.__parent?._group){e.__parent._group.zoomToShowLayer(e,()=>{e.openPopup()});return true}const i=t(()=>{e.openPopup();o.off("moveend",i)},"openPopupHandler");o.on("moveend",i);o.setView(e._latlng,15);return true},"zoomToLayer"),bindPopupPositioning:t(function(){const e=this;o.on("popupopen",function(t){var n=o.project(t.target._popup._latlng);n.y-=t.target._popup._container.clientHeight;o.panTo(o.unproject(n),{animate:true});e.updateUrlWithEntityId(t.target._popup._source)});o.on("popupclose",function(t){e.clearUrlEntityId()})},"bindPopupPositioning"),updateUrlWithEntityId:t(function(e){if(!e||!i){return}const t=i.data("leaflet");if(!t?.markers){return}const n=Object.keys(t.markers).find(n=>t.markers[n]===e);if(n){const e=n.replace("-0","");const t=new URL(window.location);t.searchParams.set("id",e);window.history.replaceState({},"",t)}},"updateUrlWithEntityId"),clearUrlEntityId:t(function(){const e=new URL(window.location);e.searchParams.delete("id");window.history.replaceState({},"",e)},"clearUrlEntityId"),getUrlParameter:t(function(e){var t=window.location.search.substring(1),n=t.split("&"),o,i;for(i=0;i<n.length;i++){o=n[i].split("=");if(o[0]===e){return typeof o[1]===void 0?true:decodeURIComponent(o[1])}}return false},"getUrlParameter")}})(jQuery,Drupal,drupalSettings,once)})();