!function(n,a,e,o){var t,r,i="comparison-map-container",c=".views--combined-map";a.behaviors.mapComparison={attach:function(a,e){var o=this;n(document).on("leafletMapInit",(function(n,e,r,i){t=r,o.bindCompareButton(a)}))},bindCompareButton:function(a){var e=this,t=n(c,a);n(o("comparison-button",".map-controls__control #map-comparison-btn",a)).on("click",(function(){t.is(".comparison-enabled")?e.disableMapComparison():e.enableMapComparison()}))},enableMapComparison:function(){var a=this,e=n("#".concat(i));a.initMap(i)?(n(c).addClass("comparison-enabled"),e.fadeIn(150),t.invalidateSize(),a.attachPopupListeners(i),setTimeout((function(){a.syncMaps()||console.error("Failed to sync maps")}),100)):console.error("Failed to initialize comparison map")},initMap:function(o){var t=n("#".concat(o)),i=Object.values(e.leaflet)[0];if(!i)return!1;var c=i.map;return c.settings.mapName="comparison-map",void 0===t.data("leaflet")&&(t.data("leaflet",new a.Leaflet(L.DomUtil.get(o),o,c)),r=t.data("leaflet").lMap,t.data("leaflet").lMap.zoomControl.remove(),i.features.length>0&&(t.data("leaflet").markers={},t.data("leaflet").features={},t.data("leaflet").add_features(i.features,!0))),!0},attachPopupListeners:function(o){n("#".concat(o)).data("leaflet").lMap.on("popupopen",(function(o){var t=o.popup._contentNode,r=n("[data-leaflet-ajax-popup]",t);if(r.length){var i=r.data("leaflet-ajax-popup");a.ajax({url:i}).execute().done((function(){o.popup.setContent(t.innerHTML),o.popup.update(),a.attachBehaviors(t,e)}))}}))},disableMapComparison:function(){var a=n("#".concat(i));n(c).removeClass("comparison-enabled"),a.fadeOut(150),this.unSyncMaps(),t.invalidateSize()},syncMaps:function(){if(!t||!r)return console.warn("Cannot sync maps: one or both maps not initialized"),!1;if("function"!=typeof t.sync||"function"!=typeof r.sync)return console.error("Leaflet.Sync plugin not loaded"),!1;try{return t.sync(r),r.sync(t),!0}catch(n){return console.error("Error syncing maps:",n),!1}},unSyncMaps:function(){if(!t||!r)return console.warn("Cannot unsync maps: one or both maps not initialized"),!1;if("function"!=typeof t.unsync||"function"!=typeof r.unsync)return console.warn("Leaflet.Sync plugin not loaded or maps not synced"),!1;try{return t.unsync(r),r.unsync(t),!0}catch(n){return console.error("Error unsyncing maps:",n),!1}}}}(jQuery,Drupal,drupalSettings,once);